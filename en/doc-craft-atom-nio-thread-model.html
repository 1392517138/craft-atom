<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8'>
	  	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	  	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	  	<link rel="icon" href="../favicon.ico" type="image/x-icon">
	  	<link rel="stylesheet" href="../css/craft.css">
		<script type="text/javascript" src="../js/jquery.js"></script>
		<script type="text/javascript" src="../js/craft.js"></script>
		<title>Documentation: craft-atom-nio Thread Model Illustration</title>
	</head>

	<body>
		<div id="header" class="header"></div>
		
		<div id="center" class="center">
			<div id="content" class="content">
<h1>craft-atom-nio: Thread Model Illustration</h1>
<div class="date">May 16, 2014 by mindwind</div>

<p>
Before we illustrate the thread model of <a href="doc-craft-atom-nio" target="_blank">craft-atom-nio</a>, think about thread model itself. 
What thread model means? it means thread collaboration mechanism and thread number decision.
</p>

<h3>Single Thread do Everything</h3>
<a href="../img/doc-craft-atom-nio-thread-model-1.png" target="_blank"><img src="../img/doc-craft-atom-nio-thread-model-1.png"></a>
<p>
As shown in figure 1, only single thread to do everything include:<br>
- Accept connection or launch connection<br>
- Read or write data<br>
- Execute business operation<br>
</p>
<p>
This is the most simple thread model, but also it is too simple too naive. Because single thread is inefficient, 
at any time just only one task can be handle.
</p>

<h3>Thread Division by Responsibility</h3>
<a href="../img/doc-craft-atom-nio-thread-model-2.png" target="_blank"><img src="../img/doc-craft-atom-nio-thread-model-2.png"></a>
<p>
As shown in figure 2, another thread model, we divide thread by the responsibility, for example:<br>
- One thread be responsible for accept or launch connection<br>
- A handful of threads be responsible for read and write data<br>
- A group of threads be responsible for execute business operation<br>
</p>
<p>
Yes this thread model is quite appropriate for <a href="doc-craft-atom-io.html" target="_blank">craft-atom-io</a> api model.
<code>IoAcceptor</code> or <code>IoConnector</code> holds one thread to be responsible for accept or launch a connection, it is a easy work, so one thread is enough.
<code>IoProcessor</code> holds a handful of threads to be responsible for read and write data, this kind of work is CPU intensive, so the default threads number is CPU core number.
</p>
<p>
Last whether we need a group independent threads to be responsible for execute business operation. It depends on the workload of business operation.
Because the inherent cost of thread hand over, if the workload of business operation is much larger than the cost, you should use a group of independent threads to execute, 
then you can get higher throughput.
</p>
			</div>
		</div>
		
		<div id="footer" class="footer"></div>
	</body>
</html>